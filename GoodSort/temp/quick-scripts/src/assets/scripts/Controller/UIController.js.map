{"version":3,"sources":["assets\\scripts\\Controller\\UIController.ts"],"names":[],"mappings":";;;;;AAAA,oBAAoB;AACpB,4EAA4E;AAC5E,mBAAmB;AACnB,sFAAsF;AACtF,8BAA8B;AAC9B,sFAAsF;;;;;;;;;;;;;;;;;;;;;;AAGtF,sDAAqD;AACrD,oDAAmD;AACnD,mDAAkD;AAClD,mDAAkD;AAE5C,IAAA,KAA8B,EAAE,CAAC,UAAU,EAAzC,OAAO,aAAA,EAAE,QAAQ,cAAA,EAAE,IAAI,UAAkB,CAAC;AAIlD;IAAkC,gCAAY;IAA9C;QAAA,qEAoGC;QAjGG,gBAAU,GAAe,IAAI,CAAC;QAE9B,aAAO,GAAY,IAAI,CAAC;QAIxB,qBAAe,GAAc,IAAI,CAAC;QAClC,SAAG,GAAc,IAAI,CAAC;QAGtB,aAAO,GAAY,IAAI,CAAC;QA2BxB,uBAAiB,GAAY,KAAK,CAAC;;IA4DvC,CAAC;IApFW,2BAAI,GAAZ;QACI,uBAAU,CAAC,MAAM,CAAC,iBAAiB,GAAG,CAAC,CAAC;QACxC,uBAAU,CAAC,IAAI,CAAC,eAAe,GAAG,EAAE,CAAC;QACrC,uBAAU,CAAC,IAAI,CAAC,KAAK,GAAG,EAAE,CAAC;QAC3B,uBAAU,CAAC,IAAI,CAAC,eAAe,GAAG,CAAC,CAAC;QACpC,uBAAU,CAAC,IAAI,CAAC,mBAAmB,GAAG,CAAC,CAAC;IAC5C,CAAC;IAGS,4BAAK,GAAf;QACI,IAAI,CAAC,IAAI,EAAE,CAAC;QACZ,uBAAU,CAAC,IAAI,CAAC,cAAc,IAAI,IAAI,CAAC,eAAe,EAAE,CAAC;IAC7D,CAAC;IAGO,sCAAe,GAAvB;QACI,IAAM,GAAG,GAAG,EAAE,CAAC,WAAW,CAAC,IAAI,CAAC,eAAe,CAAC,CAAC;QACjD,GAAG,CAAC,MAAM,GAAG,IAAI,CAAC,IAAI,CAAC;QACvB,GAAG,CAAC,WAAW,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC;QACzB,IAAI,CAAC,GAAG,GAAG,GAAG,CAAC,YAAY,CAAC,qBAAS,CAAC,CAAC;QACvC,IAAI,CAAC,UAAU,CAAC,YAAY,CAAC,GAAG,CAAC,CAAC;IACtC,CAAC;IAIO,oCAAa,GAArB;QACI,IAAI,IAAI,CAAC,iBAAiB;YAAE,OAAO;QACnC,IAAI,CAAC,iBAAiB,GAAG,IAAI,CAAC;QAC9B,IAAI,CAAC,OAAO,CAAC,MAAM,GAAG,IAAI,CAAC;IAC/B,CAAC;IAGO,sCAAe,GAAvB;QACI,IAAI,CAAC,IAAI,EAAE,CAAC;QACZ,iCAAiC;QACjC,IAAM,MAAM,GAAG,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;QAC3C,IAAI,CAAC,YAAY,CAAC;YACd,MAAM,CAAC,sBAAsB,CAAC,+BAAc,CAAC,CAAC,cAAc,EAAE,CAAC;YAC/D,uBAAU,CAAC,IAAI,CAAC,kBAAkB,GAAG,IAAI,CAAC;QAC9C,CAAC,EAAE,CAAC,CAAC,CAAA;IACT,CAAC;IAGD,kCAAW,GAAX,UAAY,IAAa;QACrB,OAAO,IAAI,CAAC,MAAM,EAAE;YAChB,IAAI,GAAG,IAAI,CAAC,MAAM,CAAC;SACtB;QACD,OAAO,IAAI,CAAC;IAChB,CAAC;IAGO,kCAAW,GAAnB;QACI,uBAAU,CAAC,IAAI,CAAC,aAAa,GAAG,IAAI,CAAC;QACrC,IAAI,CAAC,OAAO,CAAC,MAAM,GAAG,IAAI,CAAC;IAE/B,CAAC;IAGS,6BAAM,GAAhB,UAAiB,EAAU;QACvB,IAAI,uBAAU,CAAC,IAAI,CAAC,aAAa;YAAE,OAAO;QAE1C,IAAI,uBAAU,CAAC,IAAI,CAAC,KAAK,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC,MAAM,EAAE;YAC/C,IAAI,CAAC,WAAW,EAAE,CAAC;SACtB;QAED,IAAI,uBAAU,CAAC,IAAI,CAAC,cAAc,IAAI,uBAAU,CAAC,EAAE,CAAC,eAAe,EAAE;YACjE,IAAI,CAAC,aAAa,EAAE,CAAC;SACxB;QAED,IAAI,uBAAU,CAAC,IAAI,CAAC,kBAAkB,IAAI,uBAAU,CAAC,IAAI,CAAC,eAAe,IAAI,EAAE,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC,MAAM,EAAE;YACrG,IAAI,CAAC,WAAW,EAAE,CAAC;SACtB;QAED,IAAI,CAAC,uBAAU,CAAC,IAAI,CAAC,kBAAkB,IAAI,uBAAU,CAAC,IAAI,CAAC,eAAe,IAAI,EAAE,EAAE;YAC9E,IAAI,CAAC,eAAe,EAAE,CAAC;SAC1B;QAED,IAAI,uBAAU,CAAC,IAAI,CAAC,OAAO,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC,MAAM,EAAE;YACjD,IAAI,uBAAU,CAAC,IAAI,CAAC,cAAc;gBAAE,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC,MAAM,GAAG,KAAK,CAAC;YACjE,IAAI,uBAAU,CAAC,EAAE,CAAC,eAAe;gBAAE,IAAI,CAAC,OAAO,CAAC,MAAM,GAAG,KAAK,CAAC;YAC/D,IAAI,CAAC,WAAW,EAAE,CAAC;SACtB;IACL,CAAC;IA/FD;QADC,QAAQ,CAAC,uBAAU,CAAC;oDACS;IAE9B;QADC,QAAQ,CAAC,EAAE,CAAC,IAAI,CAAC;iDACM;IAIxB;QADC,QAAQ,CAAC,EAAE,CAAC,MAAM,CAAC;yDACc;IAIlC;QADC,QAAQ,CAAC,EAAE,CAAC,IAAI,CAAC;iDACM;IAbf,YAAY;QAFxB,OAAO;QACP,IAAI,CAAC,yBAAyB,CAAC;OACnB,YAAY,CAoGxB;IAAD,mBAAC;CApGD,AAoGC,CApGiC,EAAE,CAAC,SAAS,GAoG7C;AApGY,oCAAY","file":"","sourceRoot":"/","sourcesContent":["// Learn TypeScript:\r\n//  - https://docs.cocos.com/creator/2.4/manual/en/scripting/typescript.html\r\n// Learn Attribute:\r\n//  - https://docs.cocos.com/creator/2.4/manual/en/scripting/reference/attributes.html\r\n// Learn life-cycle callbacks:\r\n//  - https://docs.cocos.com/creator/2.4/manual/en/scripting/life-cycle-callbacks.html\r\n\r\nimport Board from \"../Board\";\r\nimport { Responsive } from \"../Component/Responsive\";\r\nimport { TimeCount } from \"../Component/TimeCount\";\r\nimport { ConfigData } from \"../config/GameConfig\";\r\nimport { GameController } from \"./GameController\";\r\n\r\nconst { ccclass, property, menu } = cc._decorator;\r\n\r\n@ccclass\r\n@menu(\"Controller/UIController\")\r\nexport class UIController extends cc.Component {\r\n\r\n    @property(Responsive)\r\n    Responsive: Responsive = null;\r\n    @property(cc.Node)\r\n    EndCard: cc.Node = null;\r\n\r\n\r\n    @property(cc.Prefab)\r\n    TimeCountPrefab: cc.Prefab = null;\r\n    _tc: TimeCount = null;\r\n\r\n    @property(cc.Node)\r\n    warning: cc.Node = null;\r\n\r\n\r\n    private init(): void {\r\n        ConfigData.Helper.maxRocketCanSpawn = 4;\r\n        ConfigData.Idea.fakeRocketPoses = [];\r\n        ConfigData.Idea.shelf = [];\r\n        ConfigData.Idea.shelfEatenCount = 0;\r\n        ConfigData.Idea.shelfExplosionCount = 0;\r\n    }\r\n\r\n\r\n    protected start(): void {\r\n        this.init();\r\n        ConfigData.Game.isHasTimeCount && this.createTimeCount();\r\n    }\r\n\r\n\r\n    private createTimeCount(): void {\r\n        const _tc = cc.instantiate(this.TimeCountPrefab);\r\n        _tc.parent = this.node;\r\n        _tc.setPosition(0, 0, 0);\r\n        this._tc = _tc.getComponent(TimeCount);\r\n        this.Responsive.setResObject(_tc);\r\n    }\r\n\r\n\r\n    _isActivedWarning: boolean = false;\r\n    private activeWarning(): void {\r\n        if (this._isActivedWarning) return;\r\n        this._isActivedWarning = true;\r\n        this.warning.active = true;\r\n    }\r\n\r\n\r\n    private moveToNextScene(): void {\r\n        this.init();\r\n        // Board.Instance.restartLevel();\r\n        const _Scene = this.getRootNode(this.node);\r\n        this.scheduleOnce(() => {\r\n            _Scene.getComponentInChildren(GameController).createNewLevel();\r\n            ConfigData.Game.isMovedToNextLevel = true;\r\n        }, 1)\r\n    }\r\n\r\n\r\n    getRootNode(node: cc.Node): cc.Node {\r\n        while (node.parent) {\r\n            node = node.parent;\r\n        }\r\n        return node;\r\n    }\r\n\r\n\r\n    private showEndCard(): void {\r\n        ConfigData.Game.isShowEndCard = true;\r\n        this.EndCard.active = true;\r\n\r\n    }\r\n\r\n\r\n    protected update(dt: number): void {\r\n        if (ConfigData.Game.isShowEndCard) return;\r\n\r\n        if (ConfigData.Game.isWin && !this.EndCard.active) {\r\n            this.showEndCard();\r\n        }\r\n\r\n        if (ConfigData.Game.isHasTimeCount && ConfigData.UI.isActiveWarning) {\r\n            this.activeWarning();\r\n        }\r\n\r\n        if (ConfigData.Game.isMovedToNextLevel && ConfigData.Idea.shelfEatenCount >= 24 && !this.EndCard.active) {\r\n            this.showEndCard();\r\n        }\r\n\r\n        if (!ConfigData.Game.isMovedToNextLevel && ConfigData.Idea.shelfEatenCount >= 24) {\r\n            this.moveToNextScene();\r\n        }\r\n\r\n        if (ConfigData.Game.isLoose && !this.EndCard.active) {\r\n            if (ConfigData.Game.isHasTimeCount) this._tc.node.active = false;\r\n            if (ConfigData.UI.isActiveWarning) this.warning.active = false;\r\n            this.showEndCard();\r\n        }\r\n    }\r\n\r\n}\r\n"]}